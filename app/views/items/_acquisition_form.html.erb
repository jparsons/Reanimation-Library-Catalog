<%- content_for :head do -%>
<script>
$(document).ready(function(){
	$("a#vendor-switch-link").click(function(){
		if ($(this).text() == "... or click here to add a new vendor"){
		  $(this).text("... or click here to select an existing vendor")
		  style = 'form';
		}else {
		  $(this).text("... or click here to add a new vendor");
		  style = 'dropdown'	
		}
		$.ajax({
	      url: '<%= new_vendor_path %>?style=' + style, type: 'get', dataType: 'script'
	    });	
		return false;
	})
})
</script>
<%- end -%>

<% form_for @item do |f| %>
  <%= f.error_messages %>
  <p>
    <%= f.label :title %><br />
    <%= f.text_field :title %>
  </p>

  <p>
    <%= f.label :subtitle, "Sub-Title" %><br />
    <%= f.text_field :subtitle %>
  </p>
  <p>
    <%= f.label :collection %><br />
    <%= f.select :collection_name, COLLECTIONS, :include_blank=>true %>	
  </p>
  <p><%=f.label :donors %></p>
  <p>
	<%= f.label :donors, "select from existing donors" %><br />
	  <%= f.select "donor_ids", Donor.all.map{|d| [d.name, d.id]}, {:include_blank=>true}, :size=>5, :multiple=>true %>
	  <p><%= add_child_link "... and / or click here to add new donors", f, :donors %></p>
  </p>
  <div id="donors">
  <% f.fields_for :donors do |donor_form| %>
    <%= render :partial => 'donor', :locals => {:f => donor_form} %>
  <% end %>
  </div>

  <p><%= f.label :vendor %></p>
  <p id="vendor">
  <%= render :partial => 'vendor_select', :locals=>{:f=>f} %>

  </p>
  <p><%= new_vendor_link "... or click here to add new vendor", f %></p>
 <p><%= vendor_select_link "... or click here to select an existing vendor", f %></p>
  <p><%= f.submit "Submit" %></p>
<% end %>
